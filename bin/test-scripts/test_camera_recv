#!/usr/bin/env python

import time
import sys
import os
import logging
import HeaderService
import HeaderService.SAL_tools as SAL_tools
import HeaderService.SAL_tools_send as SAL_tools_send
import HeaderService.hutils as hutils

spinner = hutils.spinner
LOGGER = hutils.create_logger(level=logging.NOTSET,name=__name__)

if __name__ == "__main__":

    
    #Filter    = SAL_tools.DDSSubcriber("camera","camera_Filter",Stype="Telemetry")
    Filter    = SAL_tools.DDSSubcriber("camera","camera_logevent_endSetFilter",Stype="Event")
    Filter.start()

    loop_n = 0
    while True:
        
        if Filter.newEvent:
            event = Filter.getCurrent()
            #print Filter.event
            filter_name = event.filterName
            LOGGER.info("Received: Filter=%s" % filter_name)
        else:
            sys.stdout.flush()
            sys.stdout.write("Filter...[{}]".format(spinner.next()))
            sys.stdout.write('\r') 
            time.sleep(0.1)

        time.sleep(0.1)
        loop_n +=1
        #print 'Loop:', loop_n

