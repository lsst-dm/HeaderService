#!/usr/bin/env python

import time
import sys
import logging
import SALPY_dmHeaderService
import HeaderService.hutils as hutils

LOGGER = hutils.create_logger(level=logging.NOTSET,name='HEADERSERVICE')

if __name__ == "__main__":
    mgr = SALPY_dmHeaderService.SAL_dmHeaderService()
    mgr.salEvent("dmHeaderService_logevent_LargeFileObjectAvailable")
    LOGGER.info("dmHeaderService_LargeFileObjectAvailable logger ready")
    event = SALPY_dmHeaderService.dmHeaderService_logevent_LargeFileObjectAvailableC()
    while True:
        retval = mgr.getEvent_LargeFileObjectAvailable(event)
        if retval==0:
            LOGGER.info("-------------------------------------------------------")
            LOGGER.info("Event dmHeaderService LargeFileObjectAvailable received")
            LOGGER.info("Byte_Size: %s" % event.Byte_Size)
            LOGGER.info("Checksum: %s" % event.Checksum)
            LOGGER.info("Generator: %s" % event.Generator)
            LOGGER.info("Mime: %s" % event.Mime)
            LOGGER.info("URL: %s" % event.URL)
            LOGGER.info("Version: %s" % event.Version)
            LOGGER.info("priority: %s" % event.priority)
        time.sleep(1)
    mgr.salShutdown()
    exit()
