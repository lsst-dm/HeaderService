#!/usr/bin/env python

import time
import MHClient
import MHClient.SAL_tools_recv as SAL_tools_recv

if __name__ == "__main__":

    # Load up the header template
    htempl= MHClient.HDRTEMPL()
    
    FK5Target = SAL_tools_recv.DDSSubcriber("tcs","tcs_kernel_FK5Target", Stype="Telemetry")
    Filter    = SAL_tools_recv.DDSSubcriber("camera","camera_Filter",Stype="Telemetry")
    Readout   = SAL_tools_recv.DDSSubcriber("camera","camera_logevent_endReadout", Stype="Event",tsleep=0.005)
        
    FK5Target.start()
    Filter.start()

    loop_n = 0
    while True:

        print "----- Loop %s ---------" % loop_n
        # Get the RA,DEC
        if FK5Target.newTelem:
            print "New value for FK5 Target"
            myData = FK5Target.getCurrentTelemetry()
            ra,dec,visitID = myData.ra, myData.dec, int(myData.rv)
            print "Received: RA=%s, DEC=%s" % (ra,dec)
            print "Received: visitID=%s" % visitID
        else:
            print "Nothing new"
            pass
        time.sleep(1)
        loop_n +=1    
